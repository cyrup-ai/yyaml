# 6.9. Node Properties

Each [node](https://yaml.org/spec/1.2.2/#nodes) may have two optional *properties*, [anchor](https://yaml.org/spec/1.2.2/#anchors-and-aliases) and [tag](https://yaml.org/spec/1.2.2/#tags), in addition to its [content](https://yaml.org/spec/1.2.2/#nodes). Node properties may be specified in any order before the [node's content](https://yaml.org/spec/1.2.2/#nodes). Either or both may be omitted.

```
[96] c-ns-properties(n,c) ::=
    (
      c-ns-tag-property
      (
        s-separate(n,c)
        c-ns-anchor-property
      )?
    )
  | (
      c-ns-anchor-property
      (
        s-separate(n,c)
        c-ns-tag-property
      )?
    )
```

**Example 6.23 Node Properties**

| ``` !!str &a1 "foo":   !!str bar &a2 baz : *a1 ``` | ```json { &B1 "foo": "bar",   "baz": *B1 } ``` |
| --- | --- |

**Legend:**

- `[c-ns-properties(n,c)](https://yaml.org/spec/1.2.2/#rule-c-ns-properties)`
- `[c-ns-anchor-property](https://yaml.org/spec/1.2.2/#rule-c-ns-anchor-property)`
- `[c-ns-tag-property](https://yaml.org/spec/1.2.2/#rule-c-ns-tag-property)`

## 6.9.1. Node Tags

The *tag property* identifies the type of the [native data structure](https://yaml.org/spec/1.2.2/#representing-native-data-structures) [presented](https://yaml.org/spec/1.2.2/#presenting-the-serialization-tree) by the [node](https://yaml.org/spec/1.2.2/#nodes). A tag is denoted by the "`!`" indicator.

```
[97] c-ns-tag-property ::=
    c-verbatim-tag
  | c-ns-shorthand-tag
  | c-non-specific-tag
```

### Verbatim Tags

A tag may be written *verbatim* by surrounding it with the " `<` " and " `>` " characters. In this case, the YAML [processor](https://yaml.org/spec/1.2.2/#processes-and-models) must deliver the verbatim tag as-is to the [application](https://yaml.org/spec/1.2.2/#processes-and-models). In particular, verbatim tags are not subject to [tag resolution](https://yaml.org/spec/1.2.2/#tag-resolution). A verbatim tag must either begin with a "`!`" (a [local tag](https://yaml.org/spec/1.2.2/#tags)) or be a valid URI (a [global tag](https://yaml.org/spec/1.2.2/#tags)).

```
[98] c-verbatim-tag ::=
  "!<"
  ns-uri-char+
  '>'
```

**Example 6.24 Verbatim Tags**

| ``` !<tag:yaml.org,2002:str> foo :   !<!bar> baz ``` | ```json { "foo": !<!bar> "baz" } ``` |
| --- | --- |

**Legend:**

- `[c-verbatim-tag](https://yaml.org/spec/1.2.2/#rule-c-verbatim-tag)`

**Example 6.25 Invalid Verbatim Tags**

| ``` - !<!> foo - !<$:?> bar ``` | ``` ERROR: - Verbatim tags aren't resolved,   so ! is invalid. - The $:? tag is neither a global   URI tag nor a local tag starting   with '!'. ``` |
| --- | --- |

### Tag Shorthands

A *tag shorthand* consists of a valid [tag handle](https://yaml.org/spec/1.2.2/#tag-handles) followed by a non-empty suffix. The [tag handle](https://yaml.org/spec/1.2.2/#tag-handles) must be associated with a [prefix](https://yaml.org/spec/1.2.2/#tag-prefixes), either by default or by using a " `TAG` " directive. The resulting [parsed](https://yaml.org/spec/1.2.2/#parsing-the-presentation-stream) [tag](https://yaml.org/spec/1.2.2/#tags) is the concatenation of the [prefix](https://yaml.org/spec/1.2.2/#tag-prefixes) and the suffix and must either begin with "`!`" (a [local tag](https://yaml.org/spec/1.2.2/#tags)) or be a valid URI (a [global tag](https://yaml.org/spec/1.2.2/#tags)).

The choice of [tag handle](https://yaml.org/spec/1.2.2/#tag-handles) is a [presentation detail](https://yaml.org/spec/1.2.2/#presenting-the-serialization-tree) and must not be used to convey [content](https://yaml.org/spec/1.2.2/#nodes) information. In particular, the [tag handle](https://yaml.org/spec/1.2.2/#tag-handles) may be discarded once [parsing](https://yaml.org/spec/1.2.2/#parsing-the-presentation-stream) is completed.

The suffix must not contain any "`!`" character. This would cause the tag shorthand to be interpreted as having a [named tag handle](https://yaml.org/spec/1.2.2/#tag-handles). In addition, the suffix must not contain the " `[`", "`]` ", " `{` ", " `}` " and "`,`" characters. These characters would cause ambiguity with [flow collection](https://yaml.org/spec/1.2.2/#flow-collection-styles) structures. If the suffix needs to specify any of the above restricted characters, they must be [escaped](https://yaml.org/spec/1.2.2/#escaped-characters) using the " `%` " character. This behavior is consistent with the URI character escaping rules (specifically, section 2.3 of URI RFC).

```
[99] c-ns-shorthand-tag ::=
  c-tag-handle
  ns-tag-char+
```

**Example 6.26 Tag Shorthands**

| ``` %TAG !e! tag:example.com,2000:app/ --- - !local foo - !!str bar - !e!tag%21 baz ``` | ```json [ !<!local> "foo",   !<tag:yaml.org,2002:str> "bar",   !<tag:example.com,2000:app/tag!> "baz" ] ``` |
| --- | --- |

**Legend:**

- `[c-ns-shorthand-tag](https://yaml.org/spec/1.2.2/#rule-c-ns-shorthand-tag)`

**Example 6.27 Invalid Tag Shorthands**

| ``` %TAG !e! tag:example,2000:app/ --- - !e! foo - !h!bar baz ``` | ``` ERROR: - The !e! handle has no suffix. - The !h! handle wasn't declared. ``` |
| --- | --- |

### Non-Specific Tags

If a [node](https://yaml.org/spec/1.2.2/#nodes) has no tag property, it is assigned a [non-specific tag](https://yaml.org/spec/1.2.2/#resolved-tags) that needs to be [resolved](https://yaml.org/spec/1.2.2/#resolved-tags) to a [specific](https://yaml.org/spec/1.2.2/#resolved-tags) one. This [non-specific tag](https://yaml.org/spec/1.2.2/#resolved-tags) is "`!`" for non- [plain scalars](https://yaml.org/spec/1.2.2/#plain-style) and "`?`" for all other [nodes](https://yaml.org/spec/1.2.2/#nodes). This is the only case where the [node style](https://yaml.org/spec/1.2.2/#node-styles) has any effect on the [content](https://yaml.org/spec/1.2.2/#nodes) information.

It is possible for the tag property to be explicitly set to the "`!`" non-specific tag. By [convention](https://yaml.org/spec/1.2.2/#resolved-tags), this "disables" [tag resolution](https://yaml.org/spec/1.2.2/#tag-resolution), forcing the [node](https://yaml.org/spec/1.2.2/#nodes) to be interpreted as " `tag:yaml.org,2002:seq` ", " `tag:yaml.org,2002:map` " or " `tag:yaml.org,2002:str` ", according to its [kind](https://yaml.org/spec/1.2.2/#nodes).

There is no way to explicitly specify the "`?`" non-specific tag. This is intentional.

```
[100] c-non-specific-tag ::= '!'
```

**Example 6.28 Non-Specific Tags**

| ``` # Assuming conventional resolution: - "12" - 12 - ! 12 ``` | ```json [ "12",   12,   "12" ] ``` |
| --- | --- |

**Legend:**

- `[c-non-specific-tag](https://yaml.org/spec/1.2.2/#rule-c-non-specific-tag)`

## 6.9.2. Node Anchors

An anchor is denoted by the " `&` " indicator. It marks a [node](https://yaml.org/spec/1.2.2/#nodes) for future reference. An [alias node](https://yaml.org/spec/1.2.2/#alias-nodes) can then be used to indicate additional inclusions of the anchored [node](https://yaml.org/spec/1.2.2/#nodes). An anchored [node](https://yaml.org/spec/1.2.2/#nodes) need not be referenced by any [alias nodes](https://yaml.org/spec/1.2.2/#alias-nodes); in particular, it is valid for all [nodes](https://yaml.org/spec/1.2.2/#nodes) to be anchored.

```
[101] c-ns-anchor-property ::=
  c-anchor          # '&'
  ns-anchor-name
```

Note that as a [serialization detail](https://yaml.org/spec/1.2.2/#serializing-the-representation-graph), the anchor name is preserved in the [serialization tree](https://yaml.org/spec/1.2.2/#serialization-tree). However, it is not reflected in the [representation](https://yaml.org/spec/1.2.2/#representation-graph) graph and must not be used to convey [content](https://yaml.org/spec/1.2.2/#nodes) information. In particular, the YAML [processor](https://yaml.org/spec/1.2.2/#processes-and-models) need not preserve the anchor name once the [representation](https://yaml.org/spec/1.2.2/#representation-graph) is [composed](https://yaml.org/spec/1.2.2/#composing-the-representation-graph).

Anchor names must not contain the " `[`", "`]` ", " `{` ", " `}` " and "`,`" characters. These characters would cause ambiguity with [flow collection](https://yaml.org/spec/1.2.2/#flow-collection-styles) structures.

```
[102] ns-anchor-char ::=
    ns-char - c-flow-indicator
```
```
[103] ns-anchor-name ::=
  ns-anchor-char+
```

**Example 6.29 Node Anchors**

| ``` First occurrence: &anchor Value Second occurrence: *anchor ``` | ```json { "First occurrence": &A "Value",   "Second occurrence": *A } ``` |
| --- | --- |

**Legend:**

- `[c-ns-anchor-property](https://yaml.org/spec/1.2.2/#rule-c-ns-anchor-property)`
- `[ns-anchor-name](https://yaml.org/spec/1.2.2/#rule-ns-anchor-name)`